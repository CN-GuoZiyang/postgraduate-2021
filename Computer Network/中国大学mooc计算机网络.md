## 第一章 计算机网络概述

### 1.1 计算机网络基本概念

#### 1.1.1 基础概念

计算机网络=通信技术+计算机技术

计算机网络是通信技术与计算机技术紧密结合的产物

通信系统模型：信源，发送设备，信道，噪声源，接收设备，信宿

计算机网络就是一种特殊的通信网络

计算机网络是互联的、自治的计算机集合

自治：无主从关系

互连：互连互通，通过通信链路

在距离较远的情况下，通过交换网络互连主机

交换网络中的重要节点被称为交换节点，通常使用路由器或交换机

Internet的两个角度解释：

- 组成细节的角度：全球最大的互连网络，ISP，网络互连，Internet是数以百万计的互连的==计算设备==的集合，主机=端系统，这些设备通过==通信链路==（光线、无线电）连接，并通过==分组交换==设备（路由器和交换机）转发分组数据包
- 服务角度：为网络应用提供通信服务的通信基础设施，为网络应用提供应用编程接口（API）

仅有硬件连接无法保证Internet，还需要==协议==

协议是计算机网络有序运行的重要保证

硬件是计算机网络的基础，然而，计算机网络中的数据交换必须遵守事先约定好的规则

任何通信或信息交换过程都需要遵循规则

网络通信：通信主体是机器，交换电子化或数字化信息

#### 1.1.2 协议

定义：网络协议简称协议，是为进行网络中的数据交换而建立的规则、标准或约定

协议规定了通信实体之间所交换的消息的格式、意义、顺序以及针对收到消息或发生的事件所采取的动作

协议的三要素：

- 语法（Syntax），数据与控制信息的结构或格式
- 语义（Semantics），需要发出何种控制信息，完成何种动作以及作出的相应，差错控制
- 时序（Timing）：事件顺序，速度匹配

协议规范了网络中所有信息发送和接收过程，是学习网络的重要内容之一，是网络创新的表现形式之一

### 1.2 计算机网络结构

#### 1.2.1 基础结构

- 网络边缘：主机，网络应用
- 接入网络，物理介质：有限或无限通信链路
- 网络核心（核心网络）：互连的路由器或分组转发设备，网络之网络

主机（端系统）：

位于网络边缘处，运行各种网络应用程序

**客户/服务器（C/S）应用模型**：客户发送请求，接收服务器响应，例如Web应用，FTP应用

**对等（P2P）应用模型**：无（或不依赖）专用服务器，通信在对等的实体之间直接进行，例如Gnutella，BT，Skype等

接入网络：

将网络边缘接入核心网（边缘路由器）

分为：住宅（家庭）接入网络，机构接入网络，移动接入网络

重要概念：

- 带宽（bandwidth）：bps
- 共享/独占

机构企业接入网络通常使用以太网

无线接入网络：通过共享等无线接入网络连接端系统与路由器，通过基站或称为接入点，分为两种：无线局域网和广域无线接入（蜂窝网）

网络核心：

互连的路由网络，关键功能：路由+转发

路由（routing）：确定分组从源到目的传输路径

转发（forwarding）：将分组从路由器的输入端口交换至正确的输出端口

网络核心解决的基本问题：实现数据从源主机通过网络核心送达目的主机：数据交换技术

#### 1.2.2 Internet结构

Internet网络：网络之网络

端系统通过**接入ISP**连接到Internet

接入ISP必须进一步连接，这样才能保证任意两个主机才可以互相发送分组

一级商业ISP：提供国家或国际范围的网络覆盖，如联通、电信、Sprint、AT&T

内容提供商网络：私有网络，连接其数据中心与Internet，通常绕过一级ISP和区域ISP

### 1.3 网络核心

#### 1.3.1 电路交换

数据交换：实现数据通过网络核心从源主机到达目的主机

交换设备：

- 动态转接
- 动态分配传输资源

数据交换的类型：

- 电路交换
- 报文交换
- 分组交换

最典型的电路交换网络：电话网络

电路交换的三个阶段：

1. 建立连接（呼叫/电路建立）
2. 通信
3. 释放连接（拆除电路）

电路交换可独占资源，无法被第三方共享

电路交换在物理层面可通过多路复用技术共享物理线路

#### 1.3.2 多路复用

多路复用，简称复用，是通信技术的基本概念

将链路/网络资源（如带宽）划分为资源片，将资源片分配给各路呼叫（calls），每路呼叫独占分配到的资源片进行通信

资源片可能闲置

典型方法：频分多路复用（FDM），时分多路复用（TDM），波分多路复用（WDM），码分多路复用（CDM）

频分多路复用：按照频率划分，互不干扰

频分多路复用的各用户占用不同的带宽资源（Hz），用户在被分配到某个频带后，都始终占用这个频带

时分多路复用：将时间划分为一段段等长的时分复用帧，每个用户在每个帧中占用固定需要的时隙，每个用户所占用的时隙时周期性出现的，周期就是帧的长度

波分多路复用：

波分复用就是光的频分复用

码分复用技术：

广泛应用于无线链路共享（蜂窝，卫星）

每个用户分配一个唯一的m bit的码片序列，其中0用-1表示，1用+1表示

各个用户使用相同频率的载波，利用各自码片序列编码数据

编码信号=原始数据*码片序列

各用户的码片序列相互正交，意味着

![](http://ww4.sinaimg.cn/large/006tNc79gy1g5za5emknzj30aw027jro.jpg)

即可保证互不干扰，解码原理

![](http://ww3.sinaimg.cn/large/006tNc79gy1g5za8awv1ej30d306mmyo.jpg)

#### 1.3.3 报文交换

报文：源（应用）发送信息整体，作为一个整体，如一个文件

#### 1.3.4 分组交换

分组：报文拆分出来的一系列相对较小大数据包，并在每个数据包前加一个头部信息，构成一个分组

分组交换需要报文的拆分与重组，可能产生额外开销（时间，空间）

分组交换的多路复用顺序不确定，数据包到达即可占用链路，这种链路共享称为统计多路复用（按需共享）

路由器暂存分组后发送到目的地，称为存储-转发（store-and-forward）

报文交换与分组交换都使用存储-转发交换方式

#### 1.3.5 报文交换与分组交换

分组交换：传输延迟

将报文拆分成较小长度为L bits的分组，在传输速率为R的链路上传输分组，延迟为
$$
\frac{L(bits)}{R(bits/sec)}
$$
报文交换：报文长度为M bits，链路带宽为R bps，每次传输报文需要M/R秒

通常，报文交换速度较快，但由于分组交换可以并行地转发分组，于是实际速度较快，且对路由器缓存能力要求较低，于是分组交换较为通用

结论：

报文M bits，链路带宽R bps，分组长度L bits，跳步数h，路由器数n（n=h-1），交付时间为
$$
T=\frac{M}{R}+\frac{(h-1)L}{R}=\frac{M}{R}+\frac{nL}{R}
$$
分组交换更加适用于突发数据传输网络，可以重复共享资源，简单，无需呼叫建立，但是可能产生拥塞，导致分组延迟或丢失，需要协议处理可靠数据传输和拥塞控制

### 1.4 计算机网络性能

#### 1.4.1 速率、带宽、延迟

速率即数据率或称为数据传输速率或比特率，最重要的性能指标

单位时间（s）传输信息（bit）量

单位b/s，或bps，kb/s，Mb/s，Gb/s

速率往往是指额定速率或者标称速率

带宽指数字信道所能传送的最高数据率，单位b/s（bps）

延迟/时延，路由器中的数据包可能会产生排队，导致延迟，路由器缓存满会导致丢包

$d_{proc}$：节点处理延迟（差错检测，输出链路的确定），通常较小，不超过ms

$d_{queue}$：排队延迟，等待输出链路可用，取决于路由器的拥塞程度

$d_{trans}$：传输延迟，传输一个分组需要的时间，取决于分组长度L，链路带宽R，$d_{trans}=L/R$

$d_{prop}$：传播延迟，数据包在链路上传输的时间，与物理链路长度d有关，也与信号传输速度s有关，铜缆传输速率通常为0.7c，约为$2\times 10^8m/s$

排队延迟：假设链路带宽R bps，分组长度L bps，平均分组到达速率a

流量强度=La/R

若接近0，表明平均排队延迟很小，接近1表明很大，超过1表示超出服务能力，平均排队延迟无限大

#### 1.4.2 时延带宽积、丢包率、吞吐量

时延带宽积=传播时延*带宽

在一秒内发送的比特数目

![](http://ww3.sinaimg.cn/large/006y8mN6gy1g67jarf9pfj30hk060dhv.jpg)

链路的时延带宽积又称为以比特为单位的链路长度

分组丢失（丢包）：

- 队列缓存容量有限
- 分组到达已满队列将被丢弃
- 丢弃分组可能由前序结点或源重发（也可能不重发）

吞吐量（吞吐率）：表示在发送端到接收端之间传送数据速率

- 即时吞吐量：给定时刻到速率
- 平均吞吐量：一段时间的平均速率

瓶颈链路：端到端路径上，限制端到端吞吐量的链路，通常是带宽最小的链路

### 1.5 计算机网络体系结构

#### 1.5.1 计算机网络体系结构概述

描述网络结构的有效方式：分层结构

计算机网络的体系结构是从功能上描述，是一种分层结构，每层遵循某个/某些网络协议完成本层的功能

计算机网络体系结构是计算机网络的各层及其协议的集合（抽象）

优点：结构清晰，模块化思想，有利于标准化

![](http://ww3.sinaimg.cn/large/006y8mN6gy1g67ky7ozz4j30ir05y413.jpg)

实体表示任何可发送或接收信息的硬件或软件进程，协议是控制两个==对等实体==进行通信的规则集合，协议是“水平的”

任一层实体需要使用下层的服务，遵循本层协议，实现本层的功能，向上层提供服务，服务是垂直的，上层的实现对上层是透明的（无法感知）

同系统的相邻实体间通过接口进行交互，通过服务访问点（SAP），交换原语，指定请求的特定服务

#### 1.5.2 OSI参考模型

OSI：开放系统互连模型，目的是支持异构网络系统的互联互通，理论成功，市场失败

将网络从功能上划分为七层，从下往上依次为：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层

![](https://ws4.sinaimg.cn/large/006Xmmmgly1g68gh6r9q6j30gj0bfae8.jpg)

主机完成七层，中间系统完成低三层，上四层从协议角度说直接从源主机对应到目标主机，上四层称为端到端层

应用层到网络层逐步加头，数据链路层还会加上尾部信息后传给物理层

数据封装原因：增加控制信息，以构造协议数据单元（PDU），控制信息包括：

- 地址：标识发送端和接收段
- 差错检测编码：用于差错检测或纠正
- 协议控制：实现协议功能的附加信息，如优先级、服务质量和安全控制等（不必要）

物理层功能：传输每个比特

- 接口特性：机械特性、电气特性、功能特性、规程（过程）特性
- 比特编码
- 数据率（传输速率）
- 比特同步：时钟同步
- 传输模式：单工（单向），半双工（交替）、全双工

数据链路层功能：

- 负责结点-结点等数据传输，物理链路直接相连的相邻结点之间的传输，传输单位为帧
- 组帧，加头加尾，方便目标成功切分数据帧
- 物理寻址，在帧头中增加发送端或接收端的物理地址标识
- 流量控制，避免淹没接收端
- 差错控制，检测并重传损坏或丢失帧，避免重复帧
- 访问（接入）控制，决定哪个设备拥有链路（物理介质）控制使用权

网络层功能：

- 负责源主机到目的主机数据分组的交互，可能穿越多个网络
- 逻辑寻址：全局唯一的逻辑地址，确保数据分组被送达目的主机
- 路由：路径选择
- 分组转发

传输层功能：

- 负责源-目的（端到端，进程间）的完整报文传输
- 报文的分段与重组
- SAP寻址
- 连接（逻辑）控制
- 流量控制

回话层功能：

- 对话控制：对话的建立与维护
- 同步：在数据流中插入同步控制点
- 是最薄的一层

表示层功能：

- 处理两个系统之间交换信息的语法和语义问题
- 数据表示转化，转换为主机独立的编码
- 加密和解密
- 压缩和解压缩

应用层功能：

- 支持用户通过用户代理（浏览器）或网络接口使用网络（服务）
- 典型的应用层服务：FTP、SMTP、HTTP

#### 1.5.3 TCP/IP参考模型

![](http://ww3.sinaimg.cn/large/006y8mN6gy1g68sn5aljhj30gs099q5n.jpg)

#### 1.5.4 五层参考模型

应用层、传输层、网络层、数据链路层、物理层

综合了OSI和TCP/IP的优点

1. 应用层：支持各种网络应用，FTP、SMTP、HTTP
2. 传输层：进程-进程的数据传输，TPC、UDP
3. 网络层：源主机到目标主机的数据分组路由与转发，IP协议、路由协议等
4. 链路层：相邻网络元素的数据传输，以太网、802.11、PPP
5. 物理层：比特传输

![](http://ww3.sinaimg.cn/large/006y8mN6gy1g68tuoof4aj30iv0bdjuu.jpg)

交换机两层，路由器三层

每一层封装完成后的数据：链路层数据帧，网络层数据报，传输层数据端，应用层报文

### 1.6 计算机网络发展历史

#### 1.6.1 计算机网络与Internet发展历史

